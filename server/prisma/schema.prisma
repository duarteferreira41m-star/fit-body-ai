generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String?
  googleId     String?  @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  profile      Profile?
  workouts     WorkoutLog[]
  dietLogs     DietLog[]
  measurements Measurement[]
  photos       Photo[]
  analyses     AnalysisResult[]
  plans        Plan[]
}

model Profile {
  id           String   @id @default(cuid())
  userId       String   @unique
  name         String?
  age          Int?
  birthDate    DateTime?
  heightCm     Int?
  gender       String?
  goal         String?
  activityLevel String?
  wakeUpTime   String?
  firstMealTime String?
  trainingTime String?
  trainingDays Int?
  trainingDurationMin Int?
  preferredFoods String?
  allergies    String?
  usesSteroids Boolean?
  steroids     String?
  updatedAt    DateTime @updatedAt
  user         User     @relation(fields: [userId], references: [id])
}

model Exercise {
  id          String   @id @default(cuid())
  name        String
  muscleGroup String?
  youtubeUrl  String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model WorkoutLog {
  id          String   @id @default(cuid())
  userId      String
  date        DateTime @default(now())
  name        String
  notes       String?
  durationMin Int?
  calories    Int?
  createdAt   DateTime @default(now())
  user        User     @relation(fields: [userId], references: [id])
}

model DietLog {
  id        String   @id @default(cuid())
  userId    String
  date      DateTime @default(now())
  calories  Int?
  proteinG  Int?
  carbsG    Int?
  fatG      Int?
  waterLiters Float?
  notes     String?
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
}

model Measurement {
  id         String   @id @default(cuid())
  userId     String
  date       DateTime @default(now())
  weightKg   Float?
  waistCm    Float?
  hipCm      Float?
  chestCm    Float?
  armCm      Float?
  thighCm    Float?
  bodyFatPct Float?
  createdAt  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id])
}

model Photo {
  id        String   @id @default(cuid())
  userId    String
  date      DateTime @default(now())
  view      String
  filePath  String
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
}

model AnalysisResult {
  id               String   @id @default(cuid())
  userId           String
  date             DateTime @default(now())
  bodyFatEstimate  Float?
  symmetryScore    Int?
  strengths        String[]
  weaknesses       String[]
  rawSummary       String?
  createdAt        DateTime @default(now())
  user             User     @relation(fields: [userId], references: [id])
}

model Plan {
  id        String   @id @default(cuid())
  userId    String
  type      String
  data      Json
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])

  @@index([userId, type])
}
